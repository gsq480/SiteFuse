name: Enhanced Child Theme from Prompt

on:
  workflow_dispatch:
    inputs:
      prompt:
        description: 'Describe your website, for example "Modern yoga studio with earth tones and mindfulness focus"'
        required: true
        type: string
      industry:
        description: 'Industry type'
        required: false
        type: choice
        options:
          - 'auto-detect'
          - 'restaurant'
          - 'yoga-studio'
          - 'law-firm'
          - 'photography'
          - 'consulting'
          - 'medical'
          - 'retail'
          - 'real-estate'
          - 'technology'
        default: 'auto-detect'

permissions:
  contents: write

jobs:
  build-deploy:
    runs-on: ubuntu-latest

    env:
      CLOUDWAYS_HOST: ${{ secrets.CLOUDWAYS_HOST }}
      CLOUDWAYS_USER: ${{ secrets.CLOUDWAYS_USER }}
      CLOUDWAYS_KEY:  ${{ secrets.CLOUDWAYS_KEY }}
      APP_PATH:       ${{ secrets.APP_PATH }}
      OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          repository: gsq480/SiteFuse
          token: ${{ secrets.GITHUB_TOKEN }}
          fetch-depth: 0
          persist-credentials: true

      - name: SSH setup
        run: |
          set -euo pipefail
          mkdir -p ~/.ssh
          chmod 700 ~/.ssh
          printf '%s\n' "$CLOUDWAYS_KEY" > ~/.ssh/id_rsa_cloudways
          chmod 600 ~/.ssh/id_rsa_cloudways
          ssh-keyscan -H "$CLOUDWAYS_HOST" >> ~/.ssh/known_hosts

      - name: Generate comprehensive website structure with AI
        id: openai
        run: |
          set -euo pipefail

          cat > /tmp/payload.json <<'EOF'
          {
            "model":"gpt-4o-mini",
            "response_format":{"type":"json_object"},
            "messages":[
              {
                "role":"system",
                "content":"You are a professional web designer creating complete website structures. Generate a complete website JSON with: slug, name, tagline, industry, designTheme, colorPalette {primary, secondary, accent, background, text}, typography {headingFont, bodyFont, accentFont}, heroSection {customHTML, heroImage}, customSections [{html}], services, testimonials, contact, footer, homepageLayout, servicesPageLayout. Use real copy. Return fully responsive Tailwind-based HTML fragments. No templating placeholders."
              },
              {
                "role":"user",
                "content":"Create a complete website for: ${{ github.event.inputs.prompt }}. Industry hint: ${{ github.event.inputs.industry }}"
              }
            ]
          }
          EOF

          curl -sS https://api.openai.com/v1/chat/completions \
            -H "Authorization: Bearer $OPENAI_API_KEY" \
            -H "Content-Type: application/json" \
            -d @/tmp/payload.json \
          | jq -r '.choices[0].message.content' > website.json

          echo "Generated website structure:"
          jq . website.json

          # Extract core variables with safe fallbacks
          SLUG=$(jq -r '.slug // "new-site"' website.json | tr '[:upper:] ' '[:lower:]-' | tr -cd 'a-z0-9-_' | sed -E 's/^-+|-+$//g')
          [ -n "$SLUG" ] || SLUG=new-site
          NAME=$(jq -r '.name // "New Site"' website.json)
          TAGLINE=$(jq -r '.tagline // "Welcome to our website"' website.json)
          INDUSTRY=$(jq -r '.industry // "general"' website.json)
          BRAND=$(jq -r '.colorPalette.primary // .brand // "#2563eb"' website.json)
          ACCENT=$(jq -r '.colorPalette.accent // .accent // "#3b82f6"' website.json)
          HERO=$(jq -r '.heroSection.heroImage // .hero // empty' website.json)
          if [ -z "$HERO" ] || [ "$HERO" = "null" ]; then
            HERO="https://images.unsplash.com/photo-1497366216548-37526070297c?w=1200&h=800&fit=crop"
          fi

          {
            echo "slug=$SLUG"
            echo "name=$NAME"
            echo "tagline=$TAGLINE"
            echo "industry=$INDUSTRY"
            echo "brand=$BRAND"
            echo "accent=$ACCENT"
            echo "hero=$HERO"
          } >> "$GITHUB_OUTPUT"

      # 2) Scaffold child theme into the workspace
      - name: Scaffold child theme in workspace
        env:
          SLUG:     ${{ steps.openai.outputs.slug }}
          NAME:     ${{ steps.openai.outputs.name }}
          TAGLINE:  ${{ steps.openai.outputs.tagline }}
          INDUSTRY: ${{ steps.openai.outputs.industry }}
          BRAND:    ${{ steps.openai.outputs.brand }}
          ACCENT:   ${{ steps.openai.outputs.accent }}
          HERO:     ${{ steps.openai.outputs.hero }}
        run: |
          set -euo pipefail
          THEME_DIR="$GITHUB_WORKSPACE/${SLUG}-child"
          mkdir -p "$THEME_DIR/assets/css" "$THEME_DIR/assets/js" "$THEME_DIR/assets/img" "$THEME_DIR/dist" "$THEME_DIR/templates" "$THEME_DIR/parts" "$THEME_DIR/inc"

          # style.css
          cat > "$THEME_DIR/style.css" <<CSS
          /*
          Theme Name: ${NAME}
          Description: Professional ${INDUSTRY} website built with SiteFuse
          Template: sitefuse-base
          Text Domain: ${SLUG}-child
          Version: 1.0.0
          */
          CSS

          # functions.php
          cat > "$THEME_DIR/functions.php" <<'PHP'
          <?php
          add_action('wp_enqueue_scripts', function () {
            $parent = get_template_directory_uri() . '/dist/tailwind.css';
            wp_enqueue_style('sitefuse-parent', $parent, [], null);

            $child_path = get_stylesheet_directory() . '/dist/tailwind.css';
            $ver = file_exists($child_path) ? filemtime($child_path) : null;
            wp_enqueue_style('sitefuse-child', get_stylesheet_directory_uri() . '/dist/tailwind.css', ['sitefuse-parent'], $ver);

            wp_enqueue_script('sitefuse-js', get_stylesheet_directory_uri() . '/assets/js/theme.js', [], $ver, true);
          });

          add_action('after_setup_theme', function () {
            add_theme_support('post-thumbnails');
            add_theme_support('custom-logo');
            add_theme_support('title-tag');
            add_theme_support('html5', ['search-form', 'comment-form', 'comment-list', 'gallery', 'caption']);
            register_nav_menus(['primary' => 'Primary Navigation', 'footer' => 'Footer Navigation']);
          });

          add_filter('nav_menu_link_attributes', function($atts, $item, $args){
            if (isset($args->theme_location) && in_array($args->theme_location, ['primary','footer'], true)) {
              $atts['class'] = trim(($atts['class'] ?? '') . ' nav-link');
            }
            return $atts;
          }, 10, 3);

          add_action('init', function() {
            register_post_type('testimonial', [
              'labels' => ['name' => 'Testimonials', 'singular_name' => 'Testimonial'],
              'public' => true, 'supports' => ['title','editor','thumbnail'], 'show_in_rest' => true,
              'menu_icon' => 'dashicons-format-quote', 'rewrite' => ['slug' => 'testimonials']
            ]);
            register_post_type('service', [
              'labels' => ['name' => 'Services', 'singular_name' => 'Service'],
              'public' => true, 'supports' => ['title','editor','thumbnail','excerpt'], 'show_in_rest' => true,
              'menu_icon' => 'dashicons-admin-tools', 'rewrite' => ['slug' => 'services']
            ]);
            register_post_type('portfolio', [
              'labels' => ['name' => 'Portfolio', 'singular_name' => 'Portfolio Item'],
              'public' => true, 'supports' => ['title','editor','thumbnail'], 'show_in_rest' => true,
              'menu_icon' => 'dashicons-portfolio', 'rewrite' => ['slug' => 'portfolio']
            ]);
          });

          function get_business_info($field) {
            $info = get_option('business_info', []);
            return $info[$field] ?? '';
          }

          add_shortcode('contact_form', function() {
            ob_start(); ?>
            <form class="contact-form space-y-4" action="#" method="post">
              <div class="grid md:grid-cols-2 gap-4">
                <input type="text" name="name" placeholder="Your Name" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
                <input type="email" name="email" placeholder="Your Email" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
              </div>
              <input type="text" name="subject" placeholder="Subject" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand">
              <textarea name="message" rows="5" placeholder="Your Message" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand"></textarea>
              <button type="submit" class="btn btn-primary w-full">Send Message</button>
            </form>
            <?php return ob_get_clean();
          });
          PHP

          # Tailwind entry CSS
          cat > "$THEME_DIR/assets/css/tailwind.css" <<CSS
          @tailwind base;
          @tailwind components;
          @tailwind utilities;

          @layer base {
            :root { --color-brand:${BRAND}; --color-brand-600:${BRAND}dd; --color-brand-700:${BRAND}bb; --color-accent:${ACCENT}; --color-cream:#fefaf6; --color-dark:#1f2937; --color-gray:#6b7280; }
            html { scroll-behavior: smooth; } body { line-height: 1.7; }
          }

          @layer components {
            .container { width: 100%; margin-inline: auto; padding-inline: 1rem; max-width: 80rem; }
            .btn { display: inline-flex; align-items: center; justify-content: center; border-radius: .75rem; padding: .875rem 2rem; font-weight: 600; transition: all .3s; text-decoration: none; }
            .btn-primary { background: linear-gradient(135deg, var(--color-brand), var(--color-accent)); color: #fff; box-shadow: 0 4px 15px rgba(0,0,0,.1); }
            .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,.15); }
            .card { background: #fff; border-radius: 1rem; box-shadow: 0 20px 40px rgba(0,0,0,.08); padding: 2.5rem; border: 1px solid rgb(241 245 249); transition: all .3s; }
            .section-title { font-size: 2.5rem; font-weight: 800; letter-spacing: -0.025em; line-height: 1.2; margin-bottom: 1rem; }
            .nav-link { color: var(--color-dark); font-weight: 500; text-decoration: none; padding: .5rem 1rem; border-radius: .5rem; transition: all .3s; }
            .nav-link:hover { background: var(--color-cream); color: var(--color-brand); }
            .footer-section { background: var(--color-dark); color: rgb(226 232 240); }
            .animate-fade-in { animation: fadeIn .8s ease-out; }
            @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
          }
          CSS

          # header.php
          cat > "$THEME_DIR/header.php" <<'PHP'
          <!doctype html>
          <html <?php language_attributes(); ?>>
          <head>
            <meta charset="<?php bloginfo('charset'); ?>">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <?php wp_head(); ?>
          </head>
          <body <?php body_class('font-sans antialiased'); ?> style="background-color: var(--color-cream); color: var(--color-dark);">
          <a class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 btn btn-primary z-50" href="#main">Skip to content</a>
          <header class="sticky top-0 z-40" style="background: rgba(255,255,255,.95); backdrop-filter: blur(12px); border-bottom: 1px solid #e5e7eb;">
            <div class="container">
              <div class="flex items-center justify-between h-20">
                <a href="<?php echo esc_url(home_url('/')); ?>" class="flex items-center space-x-2">
                  <?php if (has_custom_logo()) { the_custom_logo(); } else { ?>
                    <span style="font-size:1.5rem; font-weight:800; letter-spacing:-.025em; color:var(--color-brand);"><?php bloginfo('name'); ?></span>
                  <?php } ?>
                </a>
                <nav class="hidden lg:flex items-center space-x-1">
                  <?php wp_nav_menu(['theme_location'=>'primary','menu_class'=>'flex items-center space-x-1','container'=>false,'fallback_cb'=>'__return_empty_string']); ?>
                </nav>
                <button class="lg:hidden mobile-menu-btn p-2 rounded-lg" style="color: var(--color-brand);">
                  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                  </svg>
                </button>
              </div>
              <div class="mobile-menu hidden lg:hidden py-4 border-t border-gray-200">
                <?php wp_nav_menu(['theme_location'=>'primary','menu_class'=>'flex flex-col space-y-2','container'=>false,'fallback_cb'=>'__return_empty_string']); ?>
              </div>
            </div>
          </header>
          PHP

          # footer.php
          cat > "$THEME_DIR/footer.php" <<'PHP'
          <footer class="footer-section mt-20">
            <div class="container py-16">
              <div class="grid md:grid-cols-4 gap-8">
                <div class="md:col-span-2">
                  <h3 class="text-xl font-bold mb-4" style="color: var(--color-accent);"><?php bloginfo('name'); ?></h3>
                  <p class="text-gray-300 mb-6 max-w-md"><?php bloginfo('description'); ?></p>
                </div>
                <div>
                  <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                  <?php wp_nav_menu(['theme_location'=>'footer','menu_class'=>'space-y-2','container'=>false,'fallback_cb'=>'__return_empty_string']); ?>
                </div>
                <div>
                  <h4 class="text-lg font-semibold mb-4">Contact Info</h4>
                  <div class="space-y-2 text-gray-300">
                    <p>üìû (555) 123-4567</p>
                    <p>‚úâÔ∏è hello@<?php echo str_replace(' ', '', strtolower(get_bloginfo('name'))); ?>.com</p>
                    <p>üìç 123 Business St, City, State 12345</p>
                  </div>
                </div>
              </div>
            </div>
            <div class="border-t border-gray-700">
              <div class="container py-6">
                <div class="flex flex-col md:flex-row justify-between items-center text-gray-400 text-sm">
                  <p>¬© <?php echo date('Y'); ?> <?php bloginfo('name'); ?>. All rights reserved.</p>
                  <p>Powered by <a href="https://wordpress.org" class="hover:text-white">WordPress</a> and <span style="color: var(--color-accent);">SiteFuse</span></p>
                </div>
              </div>
            </div>
          </footer>
          <?php wp_footer(); ?>
          </body>
          </html>
          PHP

          # front-page.php
          cat > "$THEME_DIR/front-page.php" <<'PHP'
          <?php
          get_header();
          $data = [];
          $path = ABSPATH . 'website.json';
          if (file_exists($path)) {
            $json = file_get_contents($path);
            $decoded = json_decode($json, true);
            if (is_array($decoded)) { $data = $decoded; }
          }
          ?>
          <main id="main">
            <?php
              echo $data['heroSection']['customHTML'] ?? '';
              if (!empty($data['customSections']) && is_array($data['customSections'])) {
                foreach ($data['customSections'] as $section) { echo $section['html'] ?? ''; }
              }
              if (empty($data['heroSection']) && !empty($data['homepageLayout'])) { echo $data['homepageLayout']; }
            ?>
          </main>
          <?php get_footer(); ?>
          PHP

          # index.php
          cat > "$THEME_DIR/index.php" <<'PHP'
          <?php get_header(); ?>
          <main id="main" class="container py-20">
            <?php if (have_posts()) : while (have_posts()) : the_post(); the_content(); endwhile; endif; ?>
          </main>
          <?php get_footer(); ?>
          PHP

          # basic hero image
          curl -fsSL "$HERO" -o "$THEME_DIR/assets/img/hero.jpg" --max-time 15 || \
          curl -fsSL "https://images.unsplash.com/photo-1497366216548-37526070297c?w=1200&h=800&fit=crop" -o "$THEME_DIR/assets/img/hero.jpg" --max-time 10 || true

      # 3) Extract AI HTML and write Tailwind config
      - name: Extract AI HTML and write Tailwind config
        env:
          SLUG: ${{ steps.openai.outputs.slug }}
        run: |
          set -euo pipefail
          THEME_DIR="$GITHUB_WORKSPACE/${SLUG}-child"

          jq -r '[.heroSection.customHTML, (.customSections[]?.html)] | join("\n")' "$GITHUB_WORKSPACE/website.json" > "$THEME_DIR/templates/ai.html" || echo "" > "$THEME_DIR/templates/ai.html"

          cat > "$THEME_DIR/tailwind.config.js" <<'CONFIG'
          module.exports = {
            content: ['./**/*.php','./templates/**/*.html','../website.json'],
            safelist: [
              'container','btn','btn-primary','bg-primary','bg-accent','text-primary','text-accent','border-primary','border-accent','btn-secondary','card','section-title','section-subtitle',
              'hero-section','service-icon','testimonial-card','nav-link','footer-section','animate-fade-in',
              'grid','md:grid-cols-2','md:grid-cols-3','lg:grid-cols-2','gap-4','gap-8','gap-12',
              'py-20','text-center','text-white','bg-white','w-full','h-full','object-cover',
              'rounded-lg','shadow-xl','flex','items-center','justify-center','space-x-4',
              'mb-4','text-xl','font-semibold','text-gray-600','leading-relaxed'
            ],
            theme: { extend: {} },
            plugins: [],
          }
          CONFIG

      # 4) Build Tailwind CSS
      - name: Build Tailwind CSS
        env:
          SLUG: ${{ steps.openai.outputs.slug }}
        run: |
          set -euo pipefail
          THEME_DIR="$GITHUB_WORKSPACE/${SLUG}-child"
          curl -sL https://github.com/tailwindlabs/tailwindcss/releases/download/v3.4.1/tailwindcss-linux-x64 -o tailwindcss
          chmod +x tailwindcss
          ./tailwindcss -c "$THEME_DIR/tailwind.config.js" -i "$THEME_DIR/assets/css/tailwind.css" -o "$THEME_DIR/dist/tailwind.css" --minify
          test -s "$THEME_DIR/dist/tailwind.css" || { echo "Tailwind output missing"; exit 1; }

      - name: Commit generated theme back to repo
        env:
          SLUG: ${{ steps.openai.outputs.slug }}
        run: |
          set -euo pipefail
          mkdir -p child-themes
          rm -rf "child-themes/${SLUG}-child"
          mv "$GITHUB_WORKSPACE/${SLUG}-child" "child-themes/${SLUG}-child"
          git config user.name  "sitefuse-bot"
          git config user.email "bot@users.noreply.github.com"
          git add "child-themes/${SLUG}-child" website.json
          git commit -m "chore: add enhanced child theme '${SLUG}-child' with AI generated content" || echo "No changes to commit"
          git push || echo "Push skipped"

      - name: Deploy parent theme to Cloudways
        run: |
          set -euo pipefail
          PARENT_DEST="$APP_PATH/wp-content/themes/sitefuse-base"
          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "mkdir -p '$PARENT_DEST'"
          rsync -avz -e "ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no" \
            "$GITHUB_WORKSPACE/sitefuse-base/" \
            "$CLOUDWAYS_USER@$CLOUDWAYS_HOST:$PARENT_DEST/"
          echo "Deployed parent theme to: $PARENT_DEST/"

      - name: Deploy child theme and website.json to Cloudways
        env:
          SLUG: ${{ steps.openai.outputs.slug }}
        run: |
          set -euo pipefail
          THEME_DIR="$GITHUB_WORKSPACE/child-themes/${SLUG}-child"
          DEST="$APP_PATH/wp-content/themes/${SLUG}-child"

          if [ -d "$THEME_DIR" ]; then
            ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "mkdir -p '$DEST'"

            rsync -avz --delete -e "ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no" \
              "$THEME_DIR/" "$CLOUDWAYS_USER@$CLOUDWAYS_HOST:$DEST/"

            rsync -avz -e "ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no" \
              "$GITHUB_WORKSPACE/website.json" \
              "$CLOUDWAYS_USER@$CLOUDWAYS_HOST:$APP_PATH/"

            echo "Deployed child theme to: $DEST/"
          else
            echo "Theme directory not found locally, skipping deployment"
            exit 1
          fi

      - name: Create WordPress pages and content
        env:
          SLUG: ${{ steps.openai.outputs.slug }}
          NAME: ${{ steps.openai.outputs.name }}
          TAGLINE: ${{ steps.openai.outputs.tagline }}
        run: |
          set -euo pipefail

          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "cd '$APP_PATH' && which wp"

          # Update site options
          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "cd '$APP_PATH' && wp option update blogdescription '$TAGLINE' --allow-root"
          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "cd '$APP_PATH' && wp option update blogname '$NAME' --allow-root"

          # Activate theme
          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "cd '$APP_PATH' && wp theme activate '"${SLUG}-child"' --allow-root || true"

          # Create pages and assign front page
          ssh -i ~/.ssh/id_rsa_cloudways -o StrictHostKeyChecking=no "$CLOUDWAYS_USER@$CLOUDWAYS_HOST" "cd '$APP_PATH' &&
            if [ \$(wp post list --post_type=page --post_title='About' --format=count --allow-root) -eq 0 ]; then
              wp post create --post_type=page --post_title='About' --post_name='about' --post_status=publish --post_content='Learn more about our story and values.' --allow-root;
            fi
            if [ \$(wp post list --post_type=page --post_title='Services' --format=count --allow-root) -eq 0 ]; then
              wp post create --post_type=page --post_title='Services' --post_name='services' --post_status=publish --post_content='Discover our comprehensive services.' --allow-root;
            fi
            if [ \$(wp post list --post_type=page --post_title='Contact' --format=count --allow-root) -eq 0 ]; then
              wp post create --post_type=page --post_title='Contact' --post_name='contact' --post_status=publish --post_content='Get in touch with us today.' --allow-root;
            fi
            if [ \$(wp post list --post_type=page --post_name=home --format=count --allow-root) -eq 0 ]; then
              HOME_ID=\$(wp post create --post_type=page --post_title='Home' --post_name='home' --post_status=publish --post_content='Welcome to our homepage' --porcelain --allow-root);
              wp option update show_on_front page --allow-root;
              wp option update page_on_front \$HOME_ID --allow-root;
            else
              HOME_ID=\$(wp post list --post_type=page --name=home --field=ID --allow-root | head -1);
              wp option update show_on_front page --allow-root;
              wp option update page_on_front \$HOME_ID --allow-root;
            fi

            wp menu delete primary-menu --allow-root 2>/dev/null || true;
            wp menu create 'Primary Menu' --allow-root 2>/dev/null || true;
            wp menu item add-post 'Primary Menu' \$(wp post list --post_type=page --name=home --field=ID --allow-root | head -1) --title='Home' --allow-root 2>/dev/null || true;
            wp menu item add-post 'Primary Menu' \$(wp post list --post_type=page --name=about --field=ID --allow-root | head -1) --title='About' --allow-root 2>/dev/null || true;
            wp menu item add-post 'Primary Menu' \$(wp post list --post_type=page --name=services --field=ID --allow-root | head -1) --title='Services' --allow-root 2>/dev/null || true;
            wp menu item add-post 'Primary Menu' \$(wp post list --post_type=page --name=contact --field=ID --allow-root | head -1) --title='Contact' --allow-root 2>/dev/null || true;
            wp menu location assign 'Primary Menu' primary --allow-root 2>/dev/null || true
          "

          echo "‚úÖ WordPress content created successfully"